<?php
/**
 * Generated by Haxe 4.1.5
 */

namespace helder\std\php\_Boot;

use \helder\std\php\Boot;
use \helder\std\haxe\Exception;

/**
 * Closures implementation
 */
class HxClosure {
	/**
	 * @var mixed
	 * A callable value, which can be invoked by PHP
	 */
	public $callable;
	/**
	 * @var string
	 * Method name for methods
	 */
	public $func;
	/**
	 * @var mixed
	 * `this` for instance methods; php class name for static methods
	 */
	public $target;

	/**
	 * @param mixed $target
	 * @param string $func
	 * 
	 * @return void
	 */
	public function __construct ($target, $func) {
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:983: characters 3-23
		$this->target = $target;
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:984: characters 3-19
		$this->func = $func;
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:986: lines 986-988
		if (\is_null($target)) {
			#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:987: characters 4-9
			throw Exception::thrown("Unable to create closure on `null`");
		}
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:989: characters 3-104
		$this->callable = (($target instanceof HxAnon) ? $target->{$func} : [$target, $func]);
	}

	/**
	 * @see http://php.net/manual/en/language.oop5.magic.php#object.invoke
	 * 
	 * @return mixed
	 */
	public function __invoke () {
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:997: characters 3-71
		return \call_user_func_array($this->callable, \func_get_args());
	}

	/**
	 * Invoke this closure with `newThis` instead of `this`
	 * 
	 * @param mixed $newThis
	 * @param mixed $args
	 * 
	 * @return mixed
	 */
	public function callWith ($newThis, $args) {
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:1024: characters 3-65
		return \call_user_func_array($this->getCallback($newThis), $args);
	}

	/**
	 * Check if this is the same closure
	 * 
	 * @param HxClosure $closure
	 * 
	 * @return bool
	 */
	public function equals ($closure) {
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:1017: characters 10-60
		if (Boot::equal($this->target, $closure->target)) {
			#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:1017: characters 39-59
			return $this->func === $closure->func;
		} else {
			#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:1017: characters 10-60
			return false;
		}
	}

	/**
	 * Generates callable value for PHP
	 * 
	 * @param mixed $eThis
	 * 
	 * @return mixed
	 */
	public function getCallback ($eThis = null) {
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:1004: lines 1004-1006
		if ($eThis === null) {
			#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:1005: characters 4-18
			$eThis = $this->target;
		}
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:1007: lines 1007-1009
		if (($eThis instanceof HxAnon)) {
			#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:1008: characters 4-36
			return $eThis->{$this->func};
		}
		#/home/runner/haxe/versions/4.1.5/std/php/Boot.hx:1010: characters 3-39
		return [$eThis, $this->func];
	}
}

Boot::registerClass(HxClosure::class, 'php._Boot.HxClosure');
